# Решение проблемы с отображением Google Drive изображений

## Проблема
Google Drive ссылки в формате `https://drive.google.com/uc?export=view&id=...` часто не отображаются на сайтах из-за ограничений CORS и настроек доступа.

## Реализованное решение

### 1. Компонент GoogleDriveImage
Создан специальный компонент `app/components/GoogleDriveImage.vue`, который:
- Автоматически определяет Google Drive ссылки
- Пробует несколько альтернативных форматов ссылок
- Обеспечивает fallback механизм при ошибках загрузки

### 2. Альтернативные форматы ссылок
Компонент автоматически пробует следующие форматы:
1. `https://drive.google.com/uc?id=${fileId}&export=view`
2. `https://drive.google.com/thumbnail?id=${fileId}&sz=w1000`
3. `https://drive.google.com/thumbnail?id=${fileId}&sz=w800`
4. `https://drive.google.com/uc?id=${fileId}&export=download`

### 3. Автоматическая обработка в попапах
Все попапы теперь сохраняют оригинальные Google Drive ссылки в базе данных:
- `AddTourImagePopup` - изображения туров
- `AddTourPopup` - добавление туров  
- `AddYagyaPopup` - добавление ягьи
- `EditTourDetailsPopup` - редактирование деталей тура
- `AddTourDayPopup` - дни тура
- `AddTourInfoPopup` - информация о туре
- `AddYagyaInfoPopup` - информация о ягьи

### 4. Замена изображений на сайте
Все `<img>` теги заменены на `<GoogleDriveImage>` в:
- `app/pages/tours/[slug].vue` - страница тура
- `app/pages/tours/index.vue` - список туров
- `app/pages/yagya.vue` - страница ягьи

## Как это работает

### Для Google Drive ссылок:
**Вход:**
```
https://drive.google.com/file/d/14DSJPaIWS6y48AOhjsgGy9wO4TZJ2j_p/view?usp=drive_link
```

**Обработка:**
1. Компонент определяет, что это Google Drive ссылка
2. Пробует первый формат: `https://drive.google.com/uc?id=14DSJPaIWS6y48AOhjsgGy9wO4TZJ2j_p&export=view`
3. При ошибке автоматически пробует следующий формат
4. Продолжает до успешной загрузки или исчерпания всех вариантов

### Для обычных ссылок:
**Вход:**
```
https://example.com/image.jpg
```

**Обработка:**
- Отображается без изменений

## Преимущества решения

1. **Надежность**: Автоматический fallback на альтернативные форматы
2. **Совместимость**: Работает с разными настройками Google Drive
3. **Простота**: Не требует изменения логики в попапах
4. **Гибкость**: Легко добавлять новые форматы ссылок
5. **Прозрачность**: Пользователи не замечают разницы

## Техническая информация

- **Файл компонента**: `app/components/GoogleDriveImage.vue`
- **Утилита**: `utils/googleDriveUtils.js`
- **Автоматическое определение**: Google Drive ссылок по паттерну
- **Fallback механизм**: Автоматический перебор альтернативных форматов

## Результат

✅ **Google Drive изображения теперь корректно отображаются на сайте**
✅ **Обычные изображения работают без изменений**
✅ **Автоматическая обработка во всех попапах**
✅ **Надежный fallback механизм**

## Использование

Теперь вы можете вставлять Google Drive ссылки в любой попап, и они будут автоматически обработаны для правильного отображения на сайте. Компонент `GoogleDriveImage` полностью совместим с обычными изображениями и обеспечивает надежное отображение всех типов ссылок. 